# Synthetic Test Data for Staging Environment

**Purpose**: Realistic but completely fake test data for DEV3 staging sheets
**Security**: NO PHI - All data is generated by scripts
**Last Generated**: Run `node ../scripts/generate-test-data.js` to create

---

## Overview

This directory contains synthetic test data for testing Apps Script code in the staging environment (DEV3). All data is generated using faker.js and follows realistic patterns without using any real patient information.

## Data Files

### Patient Records
- **File**: `synthetic-patient.json`
- **Fields**: MRN, name, DOB, age, gender, SSN, contact info, insurance, allergies, medications
- **Format**: All MRNs start with `TEST-MRN-`
- **Example**:
  ```json
  {
    "mrn": "TEST-MRN-000001",
    "firstName": "John",
    "lastName": "Doe",
    "fullName": "Doe, John",
    "dateOfBirth": "05/15/1985",
    "age": 38,
    "ssn": "999-99-0001",
    "phone": "555-000-0001",
    "email": "john.doe@test-patient.fake"
  }
  ```

### Provider Records
- **File**: `synthetic-provider.json`
- **Fields**: NPI, name, title, specialty, license, DEA, contact info
- **Format**: All NPIs start with `999`
- **Example**:
  ```json
  {
    "npi": "9990000001",
    "firstName": "Jane",
    "lastName": "Smith",
    "title": "MD",
    "fullName": "Dr. Jane Smith, MD",
    "specialty": "Family Medicine",
    "phone": "555-100-0001"
  }
  ```

### Other Data Types

- **Appointments**: `synthetic-appointment.json`
- **Billing/Claims**: `synthetic-billing.json`
- **Lab Results**: `synthetic-lab.json`
- **Prescriptions**: `synthetic-prescription.json`

## Generating Test Data

### Quick Start

```bash
# Generate medium dataset (100 patients, 10 providers, etc.)
node ../scripts/generate-test-data.js --preset medium

# Generate small dataset (10 records each)
node ../scripts/generate-test-data.js --preset small

# Generate large dataset (1000 patients)
node ../scripts/generate-test-data.js --preset large
```

### Custom Generation

```bash
# Generate specific number of patients
node ../scripts/generate-test-data.js --schema patient --count 500

# Generate all schemas with custom counts
node ../scripts/generate-test-data.js --all-schemas --preset realistic

# Export as CSV instead of JSON
node ../scripts/generate-test-data.js --preset medium --format csv
```

## Available Presets

| Preset | Patients | Providers | Appointments | Billing | Labs | Prescriptions |
|--------|----------|-----------|--------------|---------|------|---------------|
| small | 10 | 3 | 20 | 15 | 10 | 12 |
| medium | 100 | 10 | 200 | 150 | 100 | 120 |
| large | 1000 | 25 | 2000 | 1500 | 1000 | 1200 |
| realistic | 500 | 15 | 1000 | 750 | 500 | 600 |

## Data Characteristics

### Synthetic Data Markers

All test data uses these prefixes to clearly identify it as fake:

- **MRNs**: `TEST-MRN-XXXXXX`
- **Claim IDs**: `TEST-CLAIM-XXXXXX`
- **Lab Orders**: `TEST-LAB-XXXXXX`
- **Prescriptions**: `TEST-RX-XXXXXX`
- **Insurance IDs**: `TEST-INS-XXXXXXXX`
- **Appointment IDs**: `TEST-APPT-XXXXXX`

### Realistic Patterns

Data follows realistic medical patterns:

- **Ages**: 18-90 years old
- **Appointments**: Standard office hours (8 AM - 5 PM)
- **Medications**: Common generic drugs
- **Diagnoses**: ICD-10 Z codes (status codes, not real diagnoses)
- **CPT Codes**: Common outpatient codes

### Whitelisted Values

These values are safe to use in staging (will pass PHI scan):

**Phone Numbers**:
- 555-XXX-XXXX (all 555 area codes)

**SSNs**:
- 999-99-XXXX (all start with 999-99)

**Email Domains**:
- @test-patient.fake
- @test-clinic.fake
- @test.com
- @example.com

**Addresses**:
- Any generated address (no real locations)

## Using Test Data

### In Apps Script

```javascript
// Load test patients
function getTestPatients() {
  // Read from synthetic-patient.json
  // Or generate on-the-fly
  return [
    {
      mrn: 'TEST-MRN-000001',
      name: 'Test Patient',
      dob: '01/01/1990'
    }
  ];
}

// Always use TEST- prefix for MRNs
function lookupPatient(mrn) {
  if (!mrn.startsWith('TEST-MRN-')) {
    throw new Error('Invalid test MRN - must start with TEST-MRN-');
  }
  // Your code here
}
```

### In Spreadsheets

1. Import CSV test data into DEV3 sheet
2. Use for testing formulas and functions
3. Verify outputs match expected results
4. Clear before deploying to production

## Data Relationships

Test data maintains realistic relationships:

- **Patients** have assigned **Primary Care Providers**
- **Appointments** link **Patients** to **Providers**
- **Billing** records reference **Patient MRNs**
- **Lab Results** belong to **Patients**
- **Prescriptions** link **Patients** to **Providers**

## Manifest File

After generation, a `manifest.json` file is created with metadata:

```json
{
  "generated": "2025-11-16T12:00:00.000Z",
  "preset": "medium",
  "version": "1.0.0",
  "seed": 12345,
  "schemas": {
    "patient": {
      "count": 100,
      "fields": ["mrn", "firstName", "lastName", ...],
      "description": "Synthetic patient records for testing"
    }
  }
}
```

## Reproducibility

Test data uses a fixed seed (12345) for reproducibility:
- Same preset = same data every time
- Useful for consistent testing
- Change seed in `test-data-schemas.json` if needed

## Security Notes

### What Test Data IS

✅ Completely synthetic/fake
✅ Generated by faker.js library
✅ No connection to real patients
✅ Safe for development and testing
✅ Can be shared without HIPAA concerns

### What Test Data IS NOT

❌ Not real patient information
❌ Not derived from production data
❌ Not anonymized PHI
❌ Not de-identified records

## Validation

Test data is validated before use:

```bash
# Check if data has PHI
node ../scripts/check-phi-leakage.js --file synthetic-patient.json

# Should return: ✓ No issues found
```

## Cleanup

When test data is no longer needed:

```bash
# Remove all generated files
rm -f synthetic-*.json
rm -f synthetic-*.csv
rm -f manifest.json

# Regenerate fresh data
node ../scripts/generate-test-data.js --preset medium
```

## Troubleshooting

### Issue: Not Enough Test Data

**Solution**: Generate larger preset or custom count
```bash
node ../scripts/generate-test-data.js --preset large
# or
node ../scripts/generate-test-data.js --schema patient --count 5000
```

### Issue: Need Specific Test Scenarios

**Solution**: Modify `test-data-schemas.json` to add custom patterns

### Issue: Data Looks Too Random

**Solution**: The data is intentionally random - adjust schemas for more realistic patterns if needed

## References

- **Generator Script**: `../scripts/generate-test-data.js`
- **Schemas**: `../config/test-data-schemas.json`
- **PHI Detection**: `../scripts/check-phi-leakage.js`
- **faker.js Docs**: https://fakerjs.dev/

---

**Last Updated**: 2025-11-16
**Maintained By**: AI Development Team
**Questions**: See STAGING-USAGE-GUIDE.md
